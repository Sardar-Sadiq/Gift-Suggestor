export const productDatabase = {
    tech: [
        { title: "Portable Retro Console", desc: "400-in-1 classic arcade games for gaming on the go.", price: "₹899", budget: "low", gender: "male", vibes: ["fun", "nostalgic"], occasions: ["birthday", "surprise"] },
        { title: "Smart Ambient Mood Lamp", desc: "App-controlled LED lamp with 16M colors.", price: "₹1,499", budget: "medium", gender: "any", vibes: ["useful", "classy"], occasions: ["anniversary", "birthday"] },
        { title: "RC Stunt Drone with Camera", desc: "High-speed mini drone with 4K recording.", price: "₹2,499", budget: "medium", gender: "male", vibes: ["fun"], occasions: ["birthday", "surprise"] },
        { title: "Mechanical Keyboard (RGB)", desc: "Tactile blue switches with customizable light modes.", price: "₹3,999", budget: "medium", gender: "any", vibes: ["useful", "fun"], occasions: ["birthday"] },
        { title: "Instax Mini 12 Instant Camera", desc: "Cute instant film camera for live memories.", price: "₹6,999", budget: "high", gender: "female", vibes: ["romantic", "fun"], occasions: ["valentine", "anniversary"] },
        { title: "Wireless Noise-Canceling Buds", desc: "Crystal clear sound with ergonomic design.", price: "₹2,999", budget: "medium", gender: "any", vibes: ["useful"], occasions: ["birthday", "surprise"] },
        { title: "Smart AirTag / Tracker", desc: "Never lose your keys or bag again.", price: "₹2,800", budget: "medium", gender: "any", vibes: ["useful"], occasions: ["surprise"] },
        { title: "MagSafe Power Bank", desc: "Snap-on wireless charging for your phone.", price: "₹1,200", budget: "medium", gender: "any", vibes: ["useful"], occasions: ["birthday", "surprise"] },
        { title: "RGB Headphone Stand", desc: "A stylish way to display your headset.", price: "₹850", budget: "low", gender: "any", vibes: ["fun"], occasions: ["birthday"] }
    ],
    creative: [
        { title: "Draw-Everything Sketchbook", desc: "Premium 200-page acid-free paper for artists.", price: "₹450", budget: "low", gender: "any", vibes: ["useful"], occasions: ["birthday", "surprise"] },
        { title: "3D Pen Printing Kit", desc: "Create 3D art from thin air with precision.", price: "₹1,299", budget: "medium", gender: "any", vibes: ["fun", "creative"], occasions: ["birthday"] },
        { title: "Graphite Sketching Set", desc: "Professional grade drawing pencils.", price: "₹699", budget: "low", gender: "any", vibes: ["useful"], occasions: ["surprise"] },
        { title: "Professional 80-Marker Set", desc: "Dual-tip alcohol markers for vibrant sketching.", price: "₹1,850", budget: "medium", gender: "any", vibes: ["useful", "classy"], occasions: ["birthday"] },
        { title: "Watercolor Palette & Brushes", desc: "Premium pigment cakes with self-moistening brushes.", price: "₹999", budget: "low", gender: "female", vibes: ["useful", "classy"], occasions: ["anniversary", "birthday"] },
        { title: "DIY Journaling & Sticker Box", desc: "Aesthetic scrapbooking and memories.", price: "₹799", budget: "low", gender: "female", vibes: ["romantic", "fun"], occasions: ["valentine", "anniversary"] },
        { title: "Calligraphy Starter Kit", desc: "Master the art of beautiful writing.", price: "₹1,100", budget: "medium", gender: "female", vibes: ["classy", "creative"], occasions: ["birthday"] },
        { title: "Acoustic Ukulele", desc: "Start your musical journey with this solid wood mini guitar.", price: "₹2,500", budget: "medium", gender: "any", vibes: ["fun", "romantic"], occasions: ["anniversary", "birthday"] }
    ],
    gamer: [
        { title: "Hot Wheels 5-Car Pack", desc: "Authentic 1:64 scale die-cast cars.", price: "₹649", budget: "low", gender: "male", vibes: ["fun"], occasions: ["birthday", "surprise"] },
        { title: "Level Up Mug (Controller Handle)", desc: "Ceramic mug with a gaming controller grip.", price: "₹450", budget: "low", gender: "any", vibes: ["fun", "useful"], occasions: ["surprise"] },
        { title: "Gaming Mouse (RGB)", desc: "High-DPI precision mouse with custom lighting.", price: "₹1,200", budget: "medium", gender: "male", vibes: ["useful", "fun"], occasions: ["birthday"] },
        { title: "Pastel Custom Joy-Con Skins", desc: "Soft-touch custom skins for her setup.", price: "₹599", budget: "low", gender: "female", vibes: ["fun", "classy"], occasions: ["surprise"] },
        { title: "Aesthetic Gaming Headset", desc: "High-fidelity audio with RGB attachments.", price: "₹4,500", budget: "medium", gender: "female", vibes: ["useful", "classy"], occasions: ["birthday"] },
        { title: "Neon 'GAME ON' Sign", desc: "Brighten up your gaming setup with style.", price: "₹1,800", budget: "medium", gender: "any", vibes: ["fun", "classy"], occasions: ["birthday", "surprise"] },
        { title: "Gamer Bean Bag Chair", desc: "Maximum comfort for long gaming sessions.", price: "₹3,500", budget: "medium", gender: "any", vibes: ["useful", "fun"], occasions: ["birthday"] }
    ],
    luxury: [
        { title: "Lindt Swiss Luxury Box", desc: "Exquisite heart-shaped box of melting truffles.", price: "₹850", budget: "low", gender: "any", vibes: ["romantic", "classy"], occasions: ["valentine", "anniversary"] },
        { title: "Premium Red Roses Bouquet", desc: "10-stem long-life roses in a luxury vase.", price: "₹1,499", budget: "medium", gender: "female", vibes: ["romantic"], occasions: ["valentine", "anniversary"] },
        { title: "Aromatherapy Diffuser Kit", desc: "Ultrasonic diffuser with 10 essential oils.", price: "₹1,899", budget: "medium", gender: "any", vibes: ["useful", "classy"], occasions: ["anniversary", "birthday"] },
        { title: "Gold Plated Pendant", desc: "Elegant heart-shaped minimal jewelry.", price: "₹5,500", budget: "high", gender: "female", vibes: ["romantic", "classy"], occasions: ["valentine", "anniversary"] },
        { title: "Silk Sleep Mask & Pillowcase", desc: "The ultimate beauty sleep luxury.", price: "₹1,500", budget: "medium", gender: "female", vibes: ["classy", "useful"], occasions: ["anniversary", "birthday"] },
        { title: "Luxury Bath Bomb Set", desc: "Handmade organic bath fizzies with dried petals.", price: "₹1,100", budget: "medium", gender: "female", vibes: ["romantic", "useful"], occasions: ["valentine", "surprise"] }
    ],
    reader: [
        { title: "Personalized Embossed Bookmark", desc: "Genuine leather with their name engraved.", price: "₹499", budget: "low", gender: "any", vibes: ["classy", "romantic"], occasions: ["birthday", "anniversary"] },
        { title: "Rechargeable Book Light", desc: "Eye-care warm light for late night reading.", price: "₹650", budget: "low", gender: "any", vibes: ["useful"], occasions: ["surprise"] },
        { title: "DIY Book Nook Kit", desc: "Build a tiny magical world for your bookshelf.", price: "₹2,200", budget: "medium", gender: "any", vibes: ["fun", "creative"], occasions: ["birthday", "surprise"] },
        { title: "Kindle Paperwhite", desc: "The gold standard for digital reading.", price: "₹12,499", budget: "high", gender: "any", vibes: ["useful", "classy"], occasions: ["anniversary", "birthday"] },
        { title: "Literary Scented Candle", desc: "Smells like old books and rainy days.", price: "₹750", budget: "low", gender: "any", vibes: ["romantic", "classy"], occasions: ["surprise", "valentine"] }
    ]
};

export const generateAiSuggestions = (answers) => {
    const { recipient, occasion, budget, interest, vibe } = answers;

    // 1. POOL EVERYTHING
    let fullPool = [];
    Object.keys(productDatabase).forEach(category => {
        productDatabase[category].forEach(item => {
            fullPool.push({ ...item, interestCategory: category });
        });
    });

    // 2. PRIMARY FILTER: Budget (Must match)
    let filtered = fullPool.filter(item => item.budget === budget);

    // 3. SCORING SYSTEM
    const scoredSuggestions = filtered.map(item => {
        let score = 50; // Base score

        // Interest Match
        if (item.interestCategory === interest) score += 40;

        // Gender Match
        if (item.gender === recipient) score += 30;
        else if (item.gender === 'any') score += 15;

        // Vibe Match
        if (item.vibes && item.vibes.includes(vibe)) score += 20;

        // Occasion Match
        if (item.occasions && item.occasions.includes(occasion)) score += 20;

        return { ...item, finalScore: score };
    });

    // 4. SORT AND SELECT TOP 3
    return scoredSuggestions
        .sort((a, b) => b.finalScore - a.finalScore || Math.random() - 0.5)
        .slice(0, 3)
        .map(item => ({
            ...item,
            category: item.budget.toUpperCase() + " BUDGET",
            why: (item.interestCategory === interest)
                ? `This matches their love for ${interest} and fits your budget!`
                : `A high-quality ${item.vibes ? item.vibes[0] : 'perfect'} gift that they will definitely love!`,
            platforms: [
                { name: "Amazon India", price: item.price, link: `https://www.amazon.in/s?k=${encodeURIComponent(item.title)}` },
                { name: "Flipkart", price: `₹${parseInt(item.price.replace(/[^\d]/g, '')) - 40}`, link: `https://www.flipkart.com/search?q=${encodeURIComponent(item.title)}` }
            ]
        }));
};
